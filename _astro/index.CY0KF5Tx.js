import{j as b,s as h}from"./transform.D34fbgXt.js";import"./index.es.BhrnXTIK.js";import{r as C}from"./index.BVOCwoKb.js";import{s as E}from"./styles_module.55f3f1ba.1du7dZfI.js";import{l as M}from"./linear.ChQqN_lz.js";import{a as H,b as J}from"./axis.D3QohQNI.js";import{p as K}from"./pointer.Drloq0xg.js";const t={container:{class:"block relative w-full aspect-[2/1]"},canvas:{width:900,height:450,class:" absolute inset-0 w-full h-full"},svg:{width:900,height:450,class:" absolute inset-0 w-full h-full pointer-events-none"},plot:{margin:{l:0,r:0,t:0,b:0},xr:[2.5,4],yr:[0,1],dotsize:.35,N_transient:1e3,N:2e3,N_lambda:1e3,alpha:.3,zoomalpha:.8,zoomdepth:5,zoomwindowsize:{x:.1,y:.2}}},O=(c,_)=>{const o=c,l=_,i=o.getContext("2d"),d=t.plot.xr,r=t.plot.yr,j=M().domain(d).range([t.plot.margin.l,t.svg.width-t.plot.margin.r]),I=M().domain(r).range([t.svg.height-t.plot.margin.b,t.plot.margin.t]),m=M(),p=M(),P=H(j),X=J(I);var $=0,n=d[0],s=d[1],g=n,z=(s-n)/t.plot.N_lambda,v=r[1],f=r[0],B=t.plot.alpha;const Y=e=>e?{dot:a=>`rgba(255,255,255,${a})`}:{dot:a=>`rgba(0,0,0,${a})`};h(o).style("z-index",4).style("padding","0px").style("margin","0px").style("overflow","visible").on("click",G),h(l).style("position","absolute").style("pointer-events","none").style("overflow","visible");const L=t.plot.N;var k=Y(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches);console.log(k.dot(.5));const S=(e,a)=>a*e*(1-e);window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>{k=Y(a.matches),i.clearRect(0,0,o.width,o.height),g=n,clearInterval(N),N=setInterval(A,0)});const F=(e,a,x)=>{const w=[{x,y:e}];for(let u=0;u<a;u++){const y=S(e,x);w.push({x,y}),e=y}return w.slice(t.plot.N_transient,w.length)},T=e=>{e.forEach(function(a){i.moveTo(m(a.x),p(a.y)),i.fillStyle=k.dot(B),i.beginPath(),i.arc(m(a.x),p(a.y),t.plot.dotsize,0,2*Math.PI),i.fill()})};function G(){if($+=1,$<t.plot.zoomdepth){let e=K(event,this),a=this.getBoundingClientRect(),x=this.width/a.width,w=this.height/a.height;e[0]=e[0]*x,e[1]=e[1]*w;let u=t.plot.zoomwindowsize.x*(s-n),y=t.plot.zoomwindowsize.y*(v-f),q=m.invert(e[0]),D=p.invert(e[1]);n=q-u/2,s=q+u/2,f=D-y/2,v=D+y/2,z=z*t.plot.zoomwindowsize.x,B=t.plot.zoomalpha}else n=d[0],s=d[1],z=(s-n)/t.plot.N_lambda,v=r[1],f=r[0],$=0,B=t.plot.alpha;g=n,m.domain([n,s]),p.domain([f,v]),j.domain([n,s]),I.domain([f,v]),i.clearRect(0,0,o.width,o.height),N=setInterval(A,0),h(l).selectAll("."+E.xaxis).transition().call(P),h(l).selectAll("."+E.yaxis).transition().call(X)}const R=(o.parentElement||o).getBoundingClientRect();o.width=Math.round(R.width),o.height=Math.round(R.height),m.range([0,R.width]).domain([n,s]),p.range([R.height,0]).domain([r[0],r[1]]);let N=setInterval(A,0);function A(){let e=F(Math.random(),L,g);T(e),g>s&&clearInterval(N),g+=z}return h(l).append("g").call(P).attr("class",E.xaxis).attr("transform","translate(0,"+I(0)+")"),h(l).append("g").call(X).attr("class",E.yaxis).attr("transform","translate("+j(t.plot.xr[0])+",0)"),()=>{ro.disconnect();const e=(o.parentElement||o).getBoundingClientRect();i.clearRect(0,0,e.width,e.height)}},ot=({id:c})=>{const _=C.useRef(null),o=C.useRef(null),l=C.useRef(null);return C.useEffect(()=>O(l.current,o.current),[c]),b.jsx(b.Fragment,{children:b.jsxs("div",{ref:_,id:c,className:t.container.class,children:[b.jsx("svg",{ref:o,width:t.svg.width,height:t.svg.height,className:t.svg.class,viewBox:`0 0 ${t.svg.width} ${t.svg.height}`,id:`${c}-svg`}),b.jsx("canvas",{ref:l,id:`${c}-canvas`,className:t.canvas.class,width:t.canvas.width,height:t.canvas.height})]})})};export{ot as default};
