import{j as h,s as F}from"./transform.D34fbgXt.js";import{u as O,p as L,l as P,c as Q}from"./index.es.CwlKmcND.js";import{r as z}from"./index.BVOCwoKb.js";import{s as e}from"./styles_module.1e993182.BhmgXyRO.js";import{l as X}from"./linear.C7layANc.js";import{m as n}from"./map.CZsX9b1j.js";import{r as S}from"./range.C2Q3eJqI.js";import{f as Y}from"./forEach.aRmrPUau.js";import{a as T,b as U}from"./axis.D3QohQNI.js";import{l as V}from"./line.CjWAwAWE.js";const a={container:{class:"flex flex-col "},display:{width:600,height:500,class:" p-0 mb-0 w-full h-auto "},controls:{width:600,height:175,class:"d3-widgets p-0  mb-0 w-full h-auto ",grid:{x:12,y:12}},plot:{margin:{l:60,r:20,t:20,b:50},yr:[0,1],xaxis:{label:"f(xₙ)",label_position:{x:0,y:35}},yaxis:{label:"xₙ",label_position:{x:-50,y:0}},K:100,N:200},widgets:{slider_size:350,slider_girth:8,slider_knob:10,slider_fontsize:16,sliders:[{id:"lambda",label:"λ",range:[0,4],value:2.2,position:{x:1,y:3},show:!0},{id:"x01",label:"x₀",range:[0,1],value:.023,position:{x:1,y:7},show:!0},{id:"x02",label:"x₀",range:[0,1],value:.025,position:{x:1,y:11},show:!0}],toggle_size:10,toggle_fontsize:16,toggle_label_position:"right",toggles:[{id:"attractor",label:"attractor",value:!0,position:{x:9.5,y:3}},{id:"transient",label:"transient",value:!0,position:{x:9.5,y:7}}]}},W=(r,R)=>{const s=F(r),o=F(R),N=O(a.controls.width,a.controls.height,a.controls.grid.x,a.controls.grid.y),q=a.plot.yr,D=a.plot.yr,c=X().domain(q).range([a.plot.margin.l,a.display.width-a.plot.margin.r]),p=X().domain(D).range([a.display.height-a.plot.margin.b,a.plot.margin.t]),G=T(c),H=U(p),l=V().x(t=>c(t.x)).y(t=>p(t.y)),d=n(a.widgets.sliders,t=>P().id(t.id).label(t.label).range(t.range).value(t.value).fontsize(a.widgets.slider_fontsize).size(a.widgets.slider_size).girth(a.widgets.slider_girth).knob(a.widgets.slider_knob).show(t.show).position(N.position(t.position.x,t.position.y))),m=n(a.widgets.toggles,t=>Q().id(t.id).label(t.label).value(t.value).labelposition(a.widgets.toggle_label_position).fontsize(a.widgets.toggle_fontsize).size(a.widgets.toggle_size).position(N.position(t.position.x,t.position.y)));o.selectAll(null).data(d).enter().append(L),o.selectAll(null).data(m).enter().append(L);const I=()=>{s.selectAll("*").remove(),o.selectAll("*").remove()},B=a.plot.K,u=a.plot.N,E=d[1],k=d[2],i=d[0],f=m[0],b=m[1],C=(t,A)=>A*t*(1-t),w=(t,A,J)=>{let y=[{x:t,y:0}],M=0;for(;M++<A;){let _=J*t*(1-t);y.push({x:t,y:_}),y.push({x:_,y:_}),t=_}return{transient:y.slice(0,B-1),attractor:y.slice(B,y.length)}};var x=w(E.value(),u,i.value()),g=w(k.value(),u,i.value());const v=S(0,1.01,.01);var $=n(v,t=>({x:t,y:C(t,i.value())})),j=n(v,t=>({x:t,y:t}));const K=()=>{x=w(E.value(),u,i.value()),g=w(k.value(),u,i.value()),$=n(v,t=>({x:t,y:C(t,i.value())})),j=n(v,t=>({x:t,y:t})),s.select("."+e.curve).datum($).attr("d",l),s.select("."+e.diag).datum(j).attr("d",l),s.select("."+e.trace1+"."+e.transient).datum(x.transient).attr("d",l).style("opacity",b.value()?null:0),s.select("."+e.trace2+"."+e.transient).datum(g.transient).attr("d",l).style("opacity",b.value()?null:0),s.select("."+e.trace1+"."+e.attractor).datum(x.attractor).attr("d",l).style("opacity",f.value()?null:0),s.select("."+e.trace2+"."+e.attractor).datum(g.attractor).attr("d",l).style("opacity",f.value()?null:0)};return Y(d,t=>t.update(K)),Y(m,t=>t.update(K)),s.append("g").call(G).attr("class",e.xaxis).attr("transform","translate(0,"+p(0)+")"),s.append("g").call(H).attr("class",e.yaxis).attr("transform","translate("+c(0)+",0)"),s.append("text").text(a.plot.xaxis.label).attr("class",e.axis_label).attr("transform","translate("+(c(u/2)+a.plot.xaxis.label_position.x)+","+(p(0)+a.plot.xaxis.label_position.y)+")"),s.append("text").text(a.plot.yaxis.label).attr("class",e.axis_label).attr("transform","translate("+(c(0)+a.plot.yaxis.label_position.x)+","+(p(.5)+a.plot.yaxis.label_position.y)+")"),s.append("path").datum($).attr("class",e.curve).attr("id","f").attr("d",l),s.append("path").datum(j).attr("class",e.diag).attr("id","x").attr("d",l),s.append("path").datum(x.transient).attr("d",l).attr("class",e.transient+" "+e.trace1).style("opacity",b.value()?null:0),s.append("path").datum(g.transient).attr("d",l).attr("class",e.transient+" "+e.trace2).style("opacity",b.value()?null:0),s.append("path").datum(x.attractor).attr("d",l).attr("class",e.attractor+" "+e.trace1).style("opacity",f.value()?null:0),s.append("path").datum(g.attractor).attr("d",l).attr("class",e.attractor+" "+e.trace2).style("opacity",f.value()?null:0),I},ct=({id:r})=>{const R=z.useRef(null),s=z.useRef(null),o=z.useRef(null);return z.useEffect(()=>W(s.current,o.current),[r]),h.jsx(h.Fragment,{children:h.jsxs("div",{ref:R,id:r,className:a.container.class,children:[h.jsx("svg",{ref:s,id:`${r}-display`,className:a.display.class,width:a.display.width,height:a.display.height,viewBox:`0 0 ${a.display.width} ${a.display.height}`}),h.jsx("svg",{ref:o,id:`${r}-controls`,className:a.controls.class,width:a.controls.width,height:a.controls.height,viewBox:`0 0 ${a.controls.width} ${a.controls.height}`})]})})};export{ct as default};
